<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>FriendFinder</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!-- Font Awesome Glyphicons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <!-- Chosen -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../public/css/style.css" type="text/css" />
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
</head>

<body>
    <div class="container">
        <h2>New Project</h2>
        <hr>
        <h3><strong>Project Info</strong></h3>
        <h4>Project Name</h4>
        <input type="text" name="" onBlur="validateField(project_name)" id="project_name" class="form-control" required>
        <span class="survey-error-span" id="err-pname"></span>
        <h4>Customer</h4>
        <input type="text" name="" onBlur="validateField(customer)" id="customer" class="form-control" required>
        <span class="survey-error-span" id="err-cust"></span>
        <h4>Address</h4>
        <input type="text" name="" onBlur="validateField(address)" id="address" class="form-control" required>
        <span class="survey-error-span" id="err-addr"></span>
        <h4>Contact Name</h4>
        <input type="text" name="" onBlur="validateField(contact_name)" id="contact_name" class="form-control" required>
        <span class="survey-error-span" id="err-cname"></span>
        <h4>Contact Number</h4>
        <input type="text" name="" onBlur="validateField(contact_number)" id="contact_number" class="form-control" required>
        <span class="survey-error-span" id="err-cnumb"></span>
        <h4>Account Number</h4>
        <input type="text" name="" onBlur="validateField(account_number)" id="account_number" class="form-control" required>
        <span class="survey-error-span" id="err-acnumb"></span>
        <h4>Number of Floors</h4>
        <input type="text" name="" onBlur="validateField(num_floors)" id="num_floors" class="form-control" required>
        <span class="survey-error-span" id="err-numflrs"></span>
        <h4>Other Floors</h4>
        <input type="text" name="" onBlur="validateField(other)" id="other" class="form-control" required>
        <span class="survey-error-span" id="err-otherflrs"></span>
        <h4>Scheduled Survey Date</h4>
        <input type="text" name="" onBlur="validateField(scheduled_date)" id="scheduled_date" class="form-control" required>
        <span class="survey-error-span" id="err-sched"></span>
        <h4>Comments</h4>
        <input type="text" name="" onBlur="validateField(comments)" id="comments" class="form-control">
        <span class="survey-error-span" id="err-comments"></span>
        <hr>
        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i> Submit
        </button>
        <hr>
        <footer class="footer">
            <div class="container">
                <!-- <p><a href="/api/projects">API Friends List</a> |  --><a href="https://github.com/elsagomez/EnergyLogan">GitHub Repo</a></p>
            </div>
        </footer>
    </div>
    <!-- Modal -->
    <div id="resultsModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title"><strong>Project Added</strong></h2>
                </div>
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
    // Chosen CSS
    var config = {
        '.chosen-select': {},
        '.chosen-select-deselect': {
            allow_single_deselect: true
        },
        '.chosen-select-no-single': {
            disable_search_threshold: 10
        },
        '.chosen-select-no-results': {
            no_results_text: 'Oops, nothing found!'
        },
        '.chosen-select-width': {
            width: "95%"
        }
    }
    for (var selector in config) {
        $(selector).chosen(config[selector]);
    }

    // Capture the form inputs 
    $("#submit").on("click", function() {

        // Form validation
        function validateForm() {
            var isValid = true;
            $('.form-control').each(function() {
                if ($(this).val() === '')
                    isValid = false;
            });

            $('.chosen-select').each(function() {

                if ($(this).val() === "")
                    isValid = false
            })
            return isValid;
        }

        // If all required fields are filled
        if (validateForm() == true) {
            // Create an object for the user's data
            var projectData = {
                project_name: $("#project_name").val(),
                customer: $("#customer").val(),
                address: $("#address").val(),
                contact_name: $("#contact_name").val(),
                contact_number: $("#contact_number").val(),
                account_number: $("#account_number").val(),
                num_floors: $("#num_floors").val(),
                other: $("#other").val()
                // TODO: add scheduled date and comments to project model
                scheduled_date: $("#scheduled_date").val(),
                comments: $("#comments").val(),
            }

            // if($("#comments").val().length!==0) {
            //   projectData.comments = $("#comments").val();
            // }


            // Grab the URL of the website
            var currentURL = window.location.origin;

            // AJAX post the data to the projects API. 
            $.post(currentURL + "/api/projects", projectData, function(data) {

                // Show the modal  
                $("#resultsModal").modal('toggle');

            });
        } else {
            alert("Please fill out all fields before submitting!");
        }

        return false;
    });

    function validateField(field) {

        switch (field) {
            case project_name:
                {
                    if ($("#project_name").val().trim().length === 0) {
                        $("#err-pname").text("Enter a Project Name");
                    }
                };
                break;
            case customer:
                {
                    if ($("#customer").val().trim().length === 0) {
                        $("#err-cust").text("Enter a Customer Name");
                    }
                };
                break;
            case address:
                {
                    if ($("#address").val().trim().length === 0) {
                        $("#err-addr").text("Enter an Address");
                    }
                };
                break;
            case contact_name:
                {
                    if ($("#contact_name").val().trim().length === 0) {
                        $("#err-cname").text("Enter a Customer Name");
                    }
                };
                break;
            case contact_number:
                {
                    if ($("#contact_number").val().trim().length === 0) {
                        $("#err-cnumb").text("Enter a Contact Number");
                    }
                };
                break;
            case account_number:
                {
                    if ($("#account_number").val().trim().length === 0) {
                        $("#err-acnumb").text("Enter an Account Number");
                    }
                };
                break;
            case num_floors:
                {
                    if ($("#num_floors").val().trim().length === 0) {
                        $("#err-numflrs").text("Enter the Number of Floors");
                    }
                };
                break;
            case other:
                {
                    if ($("#other").val().trim().length === 0) {
                        $("#err-otherflrs").text("Enter Other Floors");
                    }
                };
                break;
            case scheduled_date:
                {
                    if ($("#scheduled_date").val().trim().length === 0) {
                        $("#err-sched").text("Enter a Date");
                    }
                };
                break;
            default:
                console.log("ok");
        }

        // if ($("#project_name").val().trim().length === 0) {
        //     $("#err-pname").text("Enter a Project Name");
        // }

        // if ($("#customer").val().trim().length === 0) {
        //     $("#err-cust").text("Enter a Project Name");
        // }

        // if ($("#address").val().trim().length === 0) {
        //     $("#err-addr").text("Enter a Project Name");
        // }

        // if ($("#contact_name").val().trim().length === 0) {
        //     $("#err-cname").text("Enter a Project Name");
        // }

        // if ($("#contact_number").val().trim().length === 0) {
        //     $("#err-cnumb").text("Enter a Project Name");
        // }

        // if ($("#account_number").val().trim().length === 0) {
        //     $("#err-acnumb").text("Enter a Project Name");
        // }

        // if ($("#num_floors").val().trim().length === 0) {
        //     $("#err-numflrs").text("Enter a Project Name");
        // }

        // if ($("#other").val().trim().length === 0) {
        //     $("#err-otherflrs").text("Enter a Project Name");
        // }

        // if ($("#scheduled_date").val().trim().length === 0) {
        //     $("#err-sched").text("Enter a Project Name");
        // }

        // if ($("#comments").val().trim().length === 0) {
        //     $("#err-comments").text("Enter a Project Name");
        // }

        // switch (true) {
        //     case $("#project_name").val().trim().length === 0:
        //         ("#err-pname").text("Enter a Project Name");
        //         break;
        // case $("#customer").val.trim.length == 0:
        //     $("#err-cust").text = "Enter a Valid Customer Name"
        //     break;
        // case $("#address").val.trim.length == 0:
        //     $("#err-addr").text = "Enter a Valid Address"
        //     break;
        // case $("#contact_name").val.trim.length == 0:
        //     $("#err-cname").text = "Enter a Valid Contact Name"
        //     break;
        // case $("#contact_number").val.trim.length == 0:
        //     $("#err-cnumb").text = "Enter a Valid Contact Number"
        //     break;
        // case $("#account_number").val.trim.length == 0:
        //     $("#err-acnumb").text = "Enter a Valid Account Number"
        //     break;
        // case $("#num_floors").val.trim.length == 0:
        //     $("#err-numflrs").text = "Enter a Valid Number of Floors"
        //     break;
        // case $("#other").val.trim.length == 0:
        //     $("#err-otherflrs").text = "Enter a Valid Other Floor Name"
        //     break;
        // case $("#scheduled_date").val.trim.length == 0:
        //     $("#err-sched").text = "Enter a Valid Survey Date"
        //     break;
        // case $("#comments").val.trim.length == 0:
        //     $("#err-comments").text = "Enter a Valid Comment"
        //     break;
        //     default:
        //         console.log(ok);
        // }
    };
    </script>
</body>

</html>
